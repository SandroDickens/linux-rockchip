--- scripts/dtc/include-prefixes/arm/rk3036-kylin.dts	2024-03-23 21:12:48.543938626 +0800
+++ scripts/dtc/include-prefixes/arm/rk3036-kylin.dts	2024-03-23 20:32:39.716445778 +0800
@@ -8,6 +8,10 @@
 	model = "Rockchip RK3036 KylinBoard";
 	compatible = "rockchip,rk3036-kylin", "rockchip,rk3036";
 
+	chosen {
+		bootargs = "console=uart8250,mmio32,0x20068000 rw root=PARTUUID=7c0b0000-0000 rootfstype=ext4 rootwait";
+	};
+
 	memory@60000000 {
 		device_type = "memory";
 		reg = <0x60000000 0x20000000>;
@@ -36,9 +40,7 @@
 		 * - SDIO_RESET_L_WL_RST
 		 * - SDIO_RESET_L_BT_EN
 		 */
-		reset-gpios = <&gpio0 RK_PD2 GPIO_ACTIVE_LOW>, /* WL_REG_ON */
-			      <&gpio0 RK_PD3 GPIO_ACTIVE_LOW>, /* WL_RST */
-			      <&gpio2 RK_PB1 GPIO_ACTIVE_LOW>; /* BT_EN */
+		reset-gpios = <&gpio0 26 GPIO_ACTIVE_LOW>; /* WL_REG_ON */
 	};
 
 	sound {
@@ -56,12 +58,26 @@
 			"Headphone Jack", "HPOL",
 			"Headphone Jack", "HPOR";
 
-		simple-audio-card,cpu {
-			sound-dai = <&i2s>;
+		simple-audio-card,dai-link@0 {
+			format = "i2s";
+			cpu {
+				sound-dai = <&i2s>;
+			};
+
+			codec {
+				sound-dai = <&rt5616>;
+			};
 		};
 
-		simple-audio-card,codec {
-			sound-dai = <&rt5616>;
+		simple-audio-card,dai-link@1 {
+			format = "i2s";
+			cpu {
+				sound-dai = <&i2s>;
+			};
+
+			codec {
+				sound-dai = <&hdmi>;
+			};
 		};
 	};
 
@@ -73,12 +89,50 @@
 		regulator-always-on;
 		regulator-boot-on;
 	};
+
+	xin32k: xin32k {
+		compatible = "fixed-clock";
+		clock-frequency = <32768>;
+		clock-output-names = "xin32k";
+		#clock-cells = <0>;
+	};
+
+	wireless-bluetooth {
+		compatible = "bluetooth-platdata";
+		uart_rts_gpios = <&gpio0 19 GPIO_ACTIVE_LOW>;
+		pinctrl-names = "default", "rts_gpio";
+		pinctrl-0 = <&uart0_rts>;
+		pinctrl-1 = <&uart0_gpios>;
+		BT,reset_gpio = <&gpio2 9 GPIO_ACTIVE_HIGH>;
+		BT,wake_gpio = <&gpio2 8 GPIO_ACTIVE_HIGH>;
+		BT,wake_host_irq = <&gpio2 3 GPIO_ACTIVE_HIGH>;
+		status = "okay";
+	};
+
+	wireless-wlan {
+		compatible = "wlan-platdata";
+		rockchip,grf = <&grf>;
+		wifi_chip_type = "ap6212";
+		WIFI,host_wake_irq = <&gpio0 27 GPIO_ACTIVE_HIGH>;
+		status = "okay";
+	};
 };
 
 &acodec {
 	status = "okay";
 };
 
+&cpu0 {
+	cpu-supply = <&vdd_cpu>;
+};
+
+&cpu0_opp_table {
+	/delete-node/ opp-408000000;
+	/delete-node/ opp-600000000;
+	/delete-node/ opp-816000000;
+	/delete-node/ opp-1200000000;
+};
+
 &emac {
 	pinctrl-names = "default";
 	pinctrl-0 = <&emac_xfer>, <&emac_mdio>;
@@ -94,18 +148,41 @@
 };
 
 &emmc {
+	no-sdio;
+	no-sd;
 	status = "okay";
 };
 
 &gpu {
-	mali-supply = <&vdd_gpu>;
 	status = "okay";
+	mali-supply = <&vdd_cpu>;
+};
+
+/*
+ * Just as GPU's power supply is provided by cpu regulator, and fixed-frequency
+ * on CPU.
+ */
+&gpu_opp_table {
+	opp-200000000 {
+		opp-microvolt = <1150000>;
+	};
+	opp-400000000 {
+		opp-microvolt = <1150000>;
+	};
 };
 
 &hdmi {
 	status = "okay";
 };
 
+&hevc {
+	status = "okay";
+};
+
+&hevc_mmu {
+	status = "okay";
+};
+
 &i2c1 {
 	clock-frequency = <400000>;
 
@@ -121,42 +198,28 @@
 		rockchip,system-power-controller;
 		wakeup-source;
 		#clock-cells = <1>;
-		clock-output-names = "xin32k", "rk808-clkout2";
+		clock-output-names = "rk808-clkout1", "rk808-clkout2";
 
 		vcc1-supply = <&vcc_sys>;
-		vcc2-supply = <&vcc_sys>;
 		vcc3-supply = <&vcc_sys>;
 		vcc4-supply = <&vcc_sys>;
 		vcc6-supply = <&vcc_sys>;
 		vcc7-supply = <&vcc_sys>;
-		vcc8-supply = <&vcc_18>;
-		vcc9-supply = <&vcc_io>;
+		vcc9-supply = <&vcc_sys>;
 		vcc10-supply = <&vcc_io>;
-		vcc11-supply = <&vcc_sys>;
-		vcc12-supply = <&vcc_io>;
-		vddio-supply = <&vccio_pmu>;
+		vcc11-supply = <&vcc_io>;
+		vddio-supply = <&vcc_io>;
 
 		regulators {
 			vdd_cpu: DCDC_REG1 {
 				regulator-always-on;
 				regulator-boot-on;
-				regulator-min-microvolt = <750000>;
-				regulator-max-microvolt = <1350000>;
+				regulator-min-microvolt = <1150000>;
+				regulator-max-microvolt = <1150000>;
 				regulator-name = "vdd_arm";
 				regulator-state-mem {
-					regulator-off-in-suspend;
-				};
-			};
-
-			vdd_gpu: DCDC_REG2 {
-				regulator-always-on;
-				regulator-boot-on;
-				regulator-min-microvolt = <850000>;
-				regulator-max-microvolt = <1250000>;
-				regulator-name = "vdd_gpu";
-				regulator-state-mem {
 					regulator-on-in-suspend;
-					regulator-suspend-microvolt = <1000000>;
+					regulator-suspend-microvolt = <1150000>;
 				};
 			};
 
@@ -181,62 +244,62 @@
 				};
 			};
 
-			vccio_pmu: LDO_REG1 {
+			vcca_33: LDO_REG1 {
 				regulator-always-on;
 				regulator-boot-on;
 				regulator-min-microvolt = <3300000>;
 				regulator-max-microvolt = <3300000>;
-				regulator-name = "vccio_pmu";
+				regulator-name = "vcca_33";
 				regulator-state-mem {
 					regulator-on-in-suspend;
 					regulator-suspend-microvolt = <3300000>;
 				};
 			};
 
-			vcc_tp: LDO_REG2 {
+			vout1: LDO_REG2 {
 				regulator-always-on;
 				regulator-boot-on;
 				regulator-min-microvolt = <3300000>;
 				regulator-max-microvolt = <3300000>;
-				regulator-name = "vcc_tp";
+				regulator-name = "vout1";
 				regulator-state-mem {
 					regulator-off-in-suspend;
 				};
 			};
 
-			vdd_10: LDO_REG3 {
+			vdd_11: LDO_REG3 {
 				regulator-always-on;
 				regulator-boot-on;
 				regulator-min-microvolt = <1000000>;
 				regulator-max-microvolt = <1000000>;
-				regulator-name = "vdd_10";
+				regulator-name = "vdd_11";
 				regulator-state-mem {
 					regulator-on-in-suspend;
 					regulator-suspend-microvolt = <1000000>;
 				};
 			};
 
-			vcc18_lcd: LDO_REG4 {
+			vout3: LDO_REG4 {
 				regulator-always-on;
 				regulator-boot-on;
 				regulator-min-microvolt = <1800000>;
-				regulator-max-microvolt = <1800000>;
-				regulator-name = "vcc18_lcd";
+				regulator-max-microvolt = <3400000>;
+				regulator-name = "vout3";
 				regulator-state-mem {
 					regulator-on-in-suspend;
 					regulator-suspend-microvolt = <1800000>;
 				};
 			};
 
-			vccio_sd: LDO_REG5 {
+			vout4: LDO_REG5 {
 				regulator-always-on;
 				regulator-boot-on;
 				regulator-min-microvolt = <1800000>;
-				regulator-max-microvolt = <3300000>;
-				regulator-name = "vccio_sd";
+				regulator-max-microvolt = <3400000>;
+				regulator-name = "vout4";
 				regulator-state-mem {
 					regulator-on-in-suspend;
-					regulator-suspend-microvolt = <3300000>;
+					regulator-suspend-microvolt = <1800000>;
 				};
 			};
 
@@ -244,7 +307,7 @@
 				regulator-always-on;
 				regulator-boot-on;
 				regulator-min-microvolt = <1800000>;
-				regulator-max-microvolt = <2500000>;
+				regulator-max-microvolt = <3400000>;
 				regulator-name = "vout5";
 				regulator-state-mem {
 					regulator-on-in-suspend;
@@ -252,43 +315,43 @@
 				};
 			};
 
-			vcc_18: LDO_REG7 {
+			vout2: LDO_REG7 {
 				regulator-always-on;
 				regulator-boot-on;
-				regulator-min-microvolt = <1800000>;
-				regulator-max-microvolt = <1800000>;
-				regulator-name = "vcc_18";
+				regulator-min-microvolt = <800000>;
+				regulator-max-microvolt = <2500000>;
+				regulator-name = "vout2";
 				regulator-state-mem {
 					regulator-on-in-suspend;
 					regulator-suspend-microvolt = <1800000>;
 				};
 			};
 
-			vcca_codec: LDO_REG8 {
+			vcc18: LDO_REG8 {
 				regulator-always-on;
 				regulator-boot-on;
 				regulator-min-microvolt = <1800000>;
 				regulator-max-microvolt = <1800000>;
-				regulator-name = "vcca_codec";
+				regulator-name = "vcc18";
 				regulator-state-mem {
 					regulator-on-in-suspend;
 					regulator-suspend-microvolt = <1800000>;
 				};
 			};
 
-			vcc_wl: SWITCH_REG1 {
+			vswout1: SWITCH_REG1 {
 				regulator-always-on;
 				regulator-boot-on;
-				regulator-name = "vcc_wl";
+				regulator-name = "vswout1";
 				regulator-state-mem {
 					regulator-on-in-suspend;
 				};
 			};
 
-			vcc_lcd: SWITCH_REG2 {
+			vswout2: SWITCH_REG2 {
 				regulator-always-on;
 				regulator-boot-on;
-				regulator-name = "vcc_lcd";
+				regulator-name = "vswout2";
 				regulator-state-mem {
 					regulator-on-in-suspend;
 				};
@@ -311,6 +374,14 @@
 
 &i2s {
 	status = "okay";
+	pinctrl-0 = <&i2s_sclk
+		     &i2s_lrclktx
+		     &i2s_sdo
+		     &i2s_sdi>;
+};
+
+&mpp_srv {
+	status = "okay";
 };
 
 &sdio {
@@ -329,6 +400,8 @@
 	sd-uhs-sdr25;
 	sd-uhs-sdr50;
 	sd-uhs-sdr104;
+	no-mmc;
+	no-sd;
 };
 
 &sdmmc {
@@ -339,9 +412,12 @@
 	disable-wp;
 	pinctrl-names = "default";
 	pinctrl-0 = <&sdmmc_clk>, <&sdmmc_cmd>, <&sdmmc_cd>, <&sdmmc_bus4>;
+	no-mmc;
+	no-sdio;
 };
 
 &uart0 {
+	pinctrl-0 = <&uart0_xfer>, <&uart0_cts>;
 	status = "okay";
 };
 
@@ -357,6 +433,14 @@
 	status = "okay";
 };
 
+&vdpu {
+	status = "okay";
+};
+
+&vpu_mmu {
+	status = "okay";
+};
+
 &vop {
 	status = "okay";
 };
@@ -365,6 +449,10 @@
 	status = "okay";
 };
 
+&wdt {
+	status = "okay";
+};
+
 &pinctrl {
 	leds {
 		led_ctl: led-ctl {
@@ -395,4 +483,10 @@
 			rockchip,pins = <2 RK_PA7 1 &pcfg_pull_none>;
 		};
 	};
+
+	wireless-bluetooth {
+		uart0_gpios: uart0-gpios {
+			rockchip,pins = <0 RK_PC3 RK_FUNC_GPIO &pcfg_pull_none>;
+		};
+	};
 };
